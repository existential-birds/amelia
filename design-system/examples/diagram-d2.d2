# Amelia Orchestrator Flow - D2 Example
# Demonstrates the core orchestrator pattern with human-in-the-loop gate

vars: {
  background: "#0D1A12"
  surface: "#1F332E"
  text: "#EFF8E2"
  accent: "#FFC857"
  green: "#5B8A72"
  blue: "#5B9BD5"
  muted: "#88A896"
}

# Orchestrator Flow
issue: Issue {
  shape: hexagon
  style: {
    fill: ${blue}
    stroke: ${accent}
    font-color: ${text}
  }
}

architect: Architect {
  shape: rectangle
  style: {
    fill: ${surface}
    stroke: ${accent}
    font-color: ${text}
  }
}

# Human-in-the-loop gate pattern
approval: Human Approval {
  shape: diamond
  style: {
    fill: ${accent}
    stroke: ${accent}
    font-color: ${background}
    font-weight: bold
  }
}

developer: Developer {
  shape: rectangle
  style: {
    fill: ${surface}
    stroke: ${accent}
    font-color: ${text}
  }
}

reviewer: Reviewer {
  shape: rectangle
  style: {
    fill: ${surface}
    stroke: ${accent}
    font-color: ${text}
  }
}

done: Done {
  shape: hexagon
  style: {
    fill: ${green}
    stroke: ${accent}
    font-color: ${text}
  }
}

# Flow connections
issue -> architect: Fetch & Analyze {
  style: {
    stroke: ${muted}
    stroke-width: 2
  }
}

architect -> approval: Generate Plan {
  style: {
    stroke: ${muted}
    stroke-width: 2
  }
}

approval -> developer: Approved {
  style: {
    stroke: ${green}
    stroke-width: 2
  }
}

approval -> issue: Rejected {
  style: {
    stroke: ${muted}
    stroke-width: 2
    stroke-dash: 3
  }
}

developer -> reviewer: Execute Tasks {
  style: {
    stroke: ${muted}
    stroke-width: 2
  }
}

reviewer -> done: Changes Approved {
  style: {
    stroke: ${green}
    stroke-width: 2
  }
}

# Feedback loop
reviewer -> developer: Needs Revision {
  style: {
    stroke: ${accent}
    stroke-width: 2
    stroke-dash: 3
  }
}
